---
layout: post
title:  "[AI] 5. Holdout Validation & Model Fitting"
subtitle: " Learn about Data Split & Model Fitting "
category: [AI]
cover-img: /img/aipic.jpg
thumbnail-img: ""
tags: [AI]
comments: false
use_math: true
---

## 미래연구소 16기 강의 기반 정리

[http://futurelab.creatorlink.net/](http://futurelab.creatorlink.net/)

<br />

## 딥러닝 강의 5주차 - Holdout Validation & Model Fitting

<br />

본격적으로 모델을 학습할 때 필요한 딥러닝 기법을 학습할 것이다.

<br />

## 0) Hyperparameter

Parameter: (W, b) 같이 모델 내부에서 결정되는 변수

Training을 하면서 Model의 Data를 통해 자동으로 변동된다.

Hyperparameter: 사용자가 모델을 설정할 때 **직접 설정**해주는 값이다.

이를 조정하여 최적의 값을 구한다.

- Learning Rate
- Layer 개수
- Layer 내 Node의 개수
-  Iteration (Epoch) - (Gradient Descent를 몇 번이나 할 것인지)

<br />

## 1) Holdout Validation

딥러닝 모델을 만들기 위해서는 학습할 데이터를 입력으로 넣어야 한다.

하지만 정작 학습(Training)을 할 때는 모든 데이터를 입력으로 사용하지 않고 일부를 남기게 된다.

그 이유는 이 분리된 일부를 학습이 적절하게 되었는지 Test Case로 사용할 것이기 때문이다.

이처럼 검증을 위해 초반에 데이터셋을 분리하는 것을 *Holdout*이라고 한다.

<br>

만일 Test하는 데이터셋이 없으면 어떤 일이 발생할까?

이는 마치 시험을 공부하는데 문제집 하나만 계속 반복해서 푸는 것에 비유할 수 있다.

만일 같은 문제가 출제되면 성공적으로 풀 수 있겠지만, 유형이 바뀌면 풀지 못할 수도 있다.

인공지능 모델이 실생활에서 유용하려면 General한 상황에서도 맞게 예측할 수 있어야한다.

따라서 일부를 나눠서 지금까지 본 적 없는 상황에서도 대응이 가능한지 확인하도록 하는 것이다.

<br />

Dataset은 보통 **Training Set, Validation Set, Test Set** 으로 나뉜다.

![trvate](https://user-images.githubusercontent.com/86182583/128814225-dbe5f7e2-e0d1-4f62-86fb-41e56485df88.png)

## Dataset의 종류
<br />
## 1. Training Set

모델을 학습시키는 데이터다. 최적의 Parameter를 찾기 위해 Gradient Descent를 하면서 parameter를 업데이트된다.

(보통 학습을 하는 부분이 가장 중요하기에 비중을 높게 책정한다)

<br />
## 2. Validation Set

내가 설게한 모델(Custom Hyperparameter를 통해 만든 모델) 최적의 모델인지 검증하는 Dataset이다.

(그 동안 학습한 방향이 다른 문제들에서도 활용 가능한지 알아보는 **모의고사**의 역할을 한다)

Validation Set를 통과시킨 후 결과를 보고 모델이 최적인지 검정한다.

만일 부족한 점이 있다면 Hyperparameter를 직접 조절하면서 가장 효과적인 모델을 찾아내야한다

**모의고사를 외우는 것**은 향후 General Problem의 대체 능력을 측정할 수 없게 되므로

이 데이터는 Gradient Descent에 반영하지 않습니다.

<br />
## 3. Test Set

여러번의 Validation을 거친 모델을 **최종 Test**할 때 사용되는 Data이다.

(즉, 모의 평가를 통해 만들어진 실력을 **수능**에서 사용하는 것과 같다)

이것은 실전이며 **낮선** 데이터를 통해 성능을 평가하는 것이 목적이라 단 한번만 행해진다.

따라서 tuning이나 gradient descent 같은 절차는 없고, 한 번만 evaluate 해서 결과를 내는 것으로 끝난다.

<br />

### Training, Validation, Test 비율은 어떻게 정해야할까?

이는 각 Dataset마다 최적의 구조가 다르므로, 비슷한 데이터에 대한 경험적인 지식을 참고하거나

직접 적절한 Hyperparameter 조정을 통해 찾아다닐 수 밖에 없다 (**No Free Lunch Theorems**)

## Holdout 2가지 방식

### 1) 2-way Holdout = (Training + Test)

여기서 Test는 사실상 Validation의 역할을 하고, 최종 테스트는 존재하지 않는다.

### 1) 3-way Holdout = (Training + Validation + Test)

Training Data로 학습하고, Validation으로 검증하는 수차례 과정을 거친 후

최적의 모델을 찾았을 때 마지막으로 Test Set으로 검증해준다.

딥러닝 모델을 만들 때 가장 보편적인 방식이다.

<br />
<br />
## 2. Model Fitting

**Fit** 은 Train의 또 다른 이름이기도 하며(주로 CS에서 사용)

Training set 만이 아닌 Test Set에서도 예측을 잘하는 모델을 지칭한다.

우리는 모델을 학습할 때는 데이터의 일부를 (Train set, Validation Set, Test Set)으로 나누고

Epoch를 여러번 돌려서 학습시킨다. ()
